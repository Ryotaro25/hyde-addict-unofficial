{% extends "base.html" %}
{% block title %}HYDE ADDICT UNOFFICIAL | Release{% endblock %}

{% block content %}
<section class="glass-card p-4 rounded-lg">
    <div class="flex items-center justify-between mb-4">
        <h2 class="font-semibold accent text-lg">All Release</h2>
    </div>

    <!-- Artist Filter -->
    <div class="mb-4 flex flex-wrap gap-3 items-center">
        <label for="artist-filter" class="text-sm text-[var(--muted)]">アーティスト:</label>
        <select id="artist-filter" name="artist"
            class="bg-[var(--bg-2)] border border-white/10 rounded px-2 py-1 text-sm" hx-get="/music/filter"
            hx-target="#music-list" hx-trigger="change" hx-include="this, [name='release_type']">
            <option value="">全て</option>
            {% for a in artists %}
            <option value="{{ a['artist_name'] }}">{{ a['artist_name'] }}</option>
            {% endfor %}
        </select>
    </div>

    <div class="mb-4 flex flex-wrap gap-3 items-center">
        <label for="artist-filter" class="text-sm text-[var(--muted)]">形態:</label>
        <select id="artist-filter" name="release_type"
            class="bg-[var(--bg-2)] border border-white/10 rounded px-2 py-1 text-sm" hx-get="/music/filter"
            hx-target="#music-list" hx-trigger="change" hx-include="this, [name='artist']">
            <option value="">全て</option>
            <option value="single">シングル</option>
            <option value="album">アルバム</option>
            <option value="best">ベスト</option>
            <option value="live-album">ライブ音源</option>
        </select>
    </div>

    <!-- Release Items Container -->
    <div id="music-list">
        <div class="grid grid-cols-1 sm:grid-cols-3 gap-3">
            {% for m in release %}
            <div class="block p-3 rounded hover:bg-white/3 text-sm cursor-default">
                <div class="font-medium">{{ m['release_name'] }}</div>
                <div class="text-xs text-[var(--muted)]">アーティスト : {{ m['artist_name'] }}</div>
                <div class="text-xs text-[var(--muted)]">リリース日 : {{ m['formatted_date'] }}</div>
                <div class="text-xs text-[var(--muted)]">
                    形態 :
                    {% if m['release_type'] == "single" %}
                    シングル{% if m['only_digital'] == '1' %}(デジタル限定配信){% endif %}
                    {% elif m['release_type'] == "album" %}
                    アルバム{% if m['only_digital'] == '1' %}(デジタル限定配信){% endif %}
                    {% elif m['release_type'] == "video" %}
                    映像作品{% if m['only_digital'] == '1' %}(デジタル限定配信){% endif %}
                    {% elif m['release_type'] == "best" %}
                    ベストアルバム{% if m['only_digital'] == '1' %}(デジタル限定配信){% endif %}
                    {% elif m['release_type'] == "live-album" %}
                    ライブ音源{% if m['only_digital'] == '1' %}(デジタル限定配信){% endif %}
                    {% else %}
                    その他
                    {% endif %}
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</section>
{% endblock %}